---
title: "Reproducible Research: Peer Assessment 1"
author: "Henry CY Wong"
date: "2020-12-13"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

The dataset will be loaded into a data frame **data.activity** by using *read.csv*.


```r
data.activity <- read.csv("./data/activity.csv")
str(data.activity)
```

```
## 'data.frame':	17568 obs. of  3 variables:
##  $ steps   : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ date    : chr  "2012-10-01" "2012-10-01" "2012-10-01" "2012-10-01" ...
##  $ interval: int  0 5 10 15 20 25 30 35 40 45 ...
```

The **date** field of the **data.activity** will be converted from *string* to *date* as shown below:


```r
data.activity$date <- as.Date(data.activity$date, "%Y-%m-%d")
str(data.activity)
```

```
## 'data.frame':	17568 obs. of  3 variables:
##  $ steps   : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ date    : Date, format: "2012-10-01" "2012-10-01" ...
##  $ interval: int  0 5 10 15 20 25 30 35 40 45 ...
```


## Historgram of the total number of steps taken per day

The total number of steps taken each day will be aggregated as shown below:


```r
steps.per.day <- aggregate(data.activity$steps, list(data.activity$date), FUN = sum)
colnames(steps.per.day) <- c("date", "steps")
head(steps.per.day)
```

```
##         date steps
## 1 2012-10-01    NA
## 2 2012-10-02   126
## 3 2012-10-03 11352
## 4 2012-10-04 12116
## 5 2012-10-05 13294
## 6 2012-10-06 15420
```

The corresponding histogram will be generated by:


```r
hist(steps.per.day$steps,
     xlab = "Number of Steps per Day",
     ylab = "Number of Days",
     main = "Total Number of Steps Taken Each Day"
     )
```

![](PA1_template_files/figure-html/unnamed-chunk-4-1.png)<!-- -->


## What are the mean and median of the total number of steps taken per day?

The mean of the total number of steps taken per day is:


```r
mean(steps.per.day$steps, na.rm = TRUE)
```

```
## [1] 10766.19
```

The median of the total number of steps taken per day is:


```r
median(steps.per.day$steps, na.rm = TRUE)
```

```
## [1] 10765
```


## What is the average daily activity pattern?

The average number of steps taken is aggregated as shown below:


```r
steps.per.interval <- aggregate(steps ~ interval, data.activity, FUN = mean, na.rm = TRUE)
head(steps.per.interval)
```

```
##   interval     steps
## 1        0 1.7169811
## 2        5 0.3396226
## 3       10 0.1320755
## 4       15 0.1509434
## 5       20 0.0754717
## 6       25 2.0943396
```

The time series plot of the 5-minute interval and the average number of steps taken will be generated as below:


```r
with(steps.per.interval,
     plot(interval,
          steps,
          type = "l",
          xlab = "Average 5-Minute Interval",
          ylab = "Number of Steps",
          main = "Average Steps per 5-Minute Interval"
          )
    )
```

![](PA1_template_files/figure-html/unnamed-chunk-8-1.png)<!-- -->

The 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps is


```r
steps.per.interval[which.max(steps.per.interval[,2]),1]
```

```
## [1] 835
```

## Imputing missing values

The total number of missing values in the dataset is


```r
sum(is.na(data.activity[,1]))
```

```
## [1] 2304
```

It is considered to imput the missing values by the mean value of the steps of 
per interval such that the missing values to be imputed will be


```r
data.imputed <- steps.per.interval$steps[match(data.activity$interval, steps.per.interval$interval)]
```

Then, the new dataset will become


```r
data.activity.imputed <- transform(data.activity,
                                   steps = ifelse(is.na(data.activity$steps),
                                                  yes = data.imputed,
                                                  no = data.activity$steps
                                                  )
                                   )
head(data.activity.imputed)
```

```
##       steps       date interval
## 1 1.7169811 2012-10-01        0
## 2 0.3396226 2012-10-01        5
## 3 0.1320755 2012-10-01       10
## 4 0.1509434 2012-10-01       15
## 5 0.0754717 2012-10-01       20
## 6 2.0943396 2012-10-01       25
```

And the new histogram will be


```r
steps.per.day.imputed <- aggregate(data.activity.imputed$steps, list(data.activity.imputed$date), FUN = sum)
colnames(steps.per.day.imputed) <- c("date", "steps")

hist(steps.per.day.imputed$steps,
     xlab = "Number of Steps per Day",
     ylab = "Number of Days",
     main = "Total Number of Steps Taken Each Day"
     )
```

![](PA1_template_files/figure-html/unnamed-chunk-13-1.png)<!-- -->

The mean of the total number of steps taken per day after the missing values are imputed is:


```r
mean(steps.per.day.imputed$steps)
```

```
## [1] 10766.19
```

The median of the total number of steps taken per day after the missing values are imputed is:


```r
median(steps.per.day.imputed$steps)
```

```
## [1] 10766.19
```

It is found that only median is increased slightly such that mean is equal to median.
However, comparing the old and the new histograms, the total number of steps per
day between 10000 and 15000 are increased.


## Are there differences in activity patterns between weekdays and weekends?

Two fields, which are **weekday** and **type** are added into the dataset with 
missing data imputed such that corresponding date type, weekday and/or weekend 
could be identified.


```r
data.activity.imputed$weekday <- weekdays(data.activity.imputed$date)

data.activity.imputed$type <- ifelse(data.activity.imputed$weekday == "Saturday" | 
                                         data.activity.imputed$weekday == "Sunday",
                                     yes = "weekend",
                                     no = "weekday"
                                     )
head(data.activity.imputed)
```

```
##       steps       date interval weekday    type
## 1 1.7169811 2012-10-01        0  Monday weekday
## 2 0.3396226 2012-10-01        5  Monday weekday
## 3 0.1320755 2012-10-01       10  Monday weekday
## 4 0.1509434 2012-10-01       15  Monday weekday
## 5 0.0754717 2012-10-01       20  Monday weekday
## 6 2.0943396 2012-10-01       25  Monday weekday
```

A panel plot containing a time series plot of the 5-minute interval and the average 
number of steps taken across all weekday and weekend will be ploted by using
*ggplot2* as shown below:


```r
steps.per.interval.new <- aggregate(steps ~ interval + type,
                                    data = data.activity.imputed,
                                    FUN = mean,
                                    na.action = na.omit
                                    )

library(ggplot2)
ggp <- ggplot(steps.per.interval.new,
              aes(interval, steps)
              ) +
    geom_line() +
    facet_wrap(~ type, nrow = 2) +
    xlab("Average 5-Minute Interval") +
    ylab("Number Steps") +
    ggtitle("Average Steps per 5-Minute Interval for Weekday and Weekend")
print(ggp)    
```

![](PA1_template_files/figure-html/unnamed-chunk-17-1.png)<!-- -->

